---
title: 登录说明
date: 2023-12-20 17:52:28
permalink: /pages/be7a7b/
categories:
  - docs
  - 文档
  - 用户&权限
  - assets
tags:
  - 用户
---

## 前言

Jpom 目前支持的登录方式有：

- 账号+密码
- 账户+密码+验证码
- Oauth2

## 验证码

系统在启动时候会自动检查当前系统中是否可以使用验证码登录，因为验证码登录需要服务器中有字体库，所以验证码登录需要服务器支持。

当您确定服务端时候控制台看到存在：`当前服务器生成验证码异常,自动禁用验证码` 字样表示当前系统不支持验证码登录，系统会禁用验证码登录功能。

如果您想启用验证码功能则需要您自行配置字体库后重启服务端。

centos 系统：

```shell
yum install fontconfig

fc-cache --force
```

### 禁用/启用验证码登录

如果您想手动禁用验证码登录或者启动验证码登录可以到系统配置中修改

【系统管理】-> 【服务端配置】->【系统配置】-> `jpom.web.disabled-captcha`

![经验验证码](/images/user/b5e209f490534c949e550ce9508070d0.png)

##  防暴力登录账号机制

系统支持限制单个用户登录失败的次数、单 IP 登录随便次数

![锁定效果截图](/images/user/c12c4b93c41f4b84ad068d4e8529c3b3.png)

### 单用户

系统默认单个用户登录失败的次数情况如下：

- 超过 5 次则限制 30 分钟
- 超过 2*5 次则限制 1 小时
- 超过更多次则限制 10 小时

其中这个 5 次 是可以配置的：`jpom.user.always-login-error`

:::tip 注意
锁定用户是持久化的，系统重启后不会失效
:::

#### 如何提前解锁

##### 非超级管理员（非管理员）

联系管理员手动解锁

路径：【系统管理】-> 【用户管理】->【用户列表】->【更多】->解锁

![手动解锁](/images/user/b572790ea8564214a79280b37eae6aca.png)

注意：如果对应账号未锁定，此按钮是禁用状态

##### 超级管理员

如果锁定的账号是超级管理员想提前解锁：**请走忘记密码流程**

忘记密码流程请查阅文档

:::danger 注意
不建议使用常用名称如 admin、root、manager等常用用户名，避免被其他用户有意或者无意操作造成登录失败次数过多从而超级管理员账号被异常锁定
:::

### 单IP

系统默认单个 IP 登录失败次数大于 10 次时对应 IP 5H 内不能继续登录

其中这个 10 次 是可以配置的：`jpom.user.always-ip-login-error`
锁定时长也是可以配置的：`jpom.user.ip-error-lock-time`

:::tip 注意
锁定 IP 是非持久化的，系统重启后将失效
:::

#### 如何提前解锁

重启服务端

### 修改配置

路径：【系统管理】-> 【服务端配置】->【系统配置】-> [服务端系统配置]

![用户登录限制配置](/images/user/83dc151a388e4848b5d763571dcb044e.png)


## IP 访问限制

为了保证系统安全您可以开启 IP 访问限制来实现对指定 IP 限制访问或者仅开放指定 IP 才能访问

路径：【系统管理】-> 【服务端配置】->【系统配置】-> [服务端IP白名单配置]

![IP白名单配置](/images/user/0dcbcf30e4e24bea81810882e1271710.png)


### 如何恢复

如果您配置错误造成您自己无法正常访问或者 IP 地址变动需要重新配置但是您无法访问则可以删除当前配置来解决

#### linux 
```shell
bash /xxxx/Server.sh restart -15 --rest:ip_config
```

#### windows

```shell
Server.bat restart --rest:ip_config
```

:::tip 注意
目前仅支持限制 IPV4
:::


