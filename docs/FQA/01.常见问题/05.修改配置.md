---
title: 修改配置
date: 2022-07-25 16:45:23
permalink: /pages/98500f/
categories:
  - docs
  - FQA
  - 常见问题
tags:
  - 
---

[[toc]]


## 如何修改Jpom自身控制台日志级别

修改管理程序命令文件中`--spring.profiles.active=`属性值`pro/dev`

## 如何修改程序日志路径

修改管理程序命令文件中 --jpom.log=/jpom/log/

## 如何指定Jpom运行 jvm 内存

修改管理程序命令文件中 JVM 变量添加 -Xms512m -Xmx1024m

## 如何修改程序运行端口

修改管理程序命令(Server.sh/Server.bat)文件中 `--server.port=2122`

修改管理程序命令(Agent.sh/Agent.bat)文件中 `--server.port=2123`

## 如何修改Jpom数据存储目录

 修改外部配置文件`extConfig.yml`中的 jpom.path 属性

```yaml
jpom:
  # jpom 数据存储路径, 如果调试模式运行默认路径为【${user.home}/jpom/】,安装运行默认为jar包文件的父级
  path:
  authorize:
    # agent 端管理账号，必填。
    agentName: jpomAgent
    # agent 端管理密码，非必填，如果为空Jpom 会自动生成一串随机字符串当密码
    agentPwd:
```

## 如何修改Jpom插件端账户/密码

修改插件端外部配置文件`extConfig.yml`中的 jpom.authorize.agentName 和 jpom.authorize.agentPwd 属性

```yaml
jpom:
  # jpom 数据存储路径, 如果调试模式运行默认路径为【${user.home}/jpom/】,安装运行默认为jar包文件的父级
  path:
  authorize:
    # agent 端管理账号，必填。
    agentName: jpomAgent
    # agent 端管理密码，非必填，如果为空Jpom 会自动生成一串随机字符串当密码
    agentPwd:
```

## 查看控制台日志中文乱码

由于目前采用自动识别文件编码格式，可能不准确，如果明确日志文件编码格式。可以在插件端的外部文件【extConfig.yml】中指定

```yaml
log:
  # 日志文件的编码格式，如果没有指定就自动识别，自动识别可能出现不准确的情况
  fileCharset:
  # 查看日志时初始读取最后多少行（默认10，0不读取）
  intiReadLine: 10
```

## 配置上传文件大小限制

Jpom 上传文件大小限制默认为 1GB，如果有上传更大到文件需要修改限制大小

Jpom 使用 SpringBoot 实现，大部分配置遵循 SpringBoot 配置属性。

上传文件大小限制配置属性为：

```yaml
spring:
  servlet:
    multipart:
      # 上传文件大小限制
      max-request-size: 2GB
      max-file-size: 1GB
```

如果上传大文件出现 OOM 那么则需要为程序配置更大的内存，因为上传文件默认都会先缓存到内存中

配置方式为：修改配置文件(`extConfig.yml`)中对应属性值


## 项目日志占用太多存储空间怎么办？

可以配置项目控制台日志存储规则：（在节点管理>系统管理>系统配置 中修改）

```yaml
log:
  # 检测控制台日志周期，防止日志文件过大，目前暂只支持linux 不停服备份
  autoBackConsoleCron: 0 0/1 * * * ?
  # 控制台日志文件保留大小
  autoBackSize: 10MB
  # 是否自动将控制台日志文件备份
  autoBackToFile: false
  # 保存天数 配置错误或者没有，默认是7天
  saveDays: 1
```

参考上面配置修改保存并重启后，这样单个项目的控制台日志文件将控制在 10M、并且不会产生日志备份文件

注意：参考配置中检测周期为 1 分钟，如果你项目在 1 分钟的周期内会产生 10M 的内容，那么会在下一次检测进行清空。


## 如何关闭项目日志（控制台日志）自动备份

Jpom 中的项目控制台日志默认开启了备份的，但是您在项目日志太多并且存储资源有限的情况下可以选择关闭备份这样节省存储空间

```yaml
log:
  # 是否自动将控制台日志文件备份
  autoBackToFile: false
  # 保存天数 配置错误或者没有，默认是7天
  saveDays: 1
```

配置页面路径：节点管理>系统管理>系统配置

## 构建历史占空间太大（在线构建文件占用空间过大）？

Jpom 的在线构建默认会缓存仓库相关的文件，同时执行一次构建也将产生构建日志，保留构建产物相关的文件。

构建历史主要用户查看构建日志、下载构建产物、回滚构建产物等操作

随着构建功能使用频率提高构建历史占用的空间会逐步增加。

该如果清理或者减少报错文件：

1. 配置统一规则
2. 单个构建配置是否保留构建产物

配置统一规则参考服务端 extConfig.yml 配置文件：

注意：修改配置后不会立即生效，会在下次触发构建时候执行检查保留规则

```yaml
# 构建相关配置
build:
  # 最多保存多少份历史记录
  maxHistoryCount: 1000
  # 单个最多保存多少份历史记录
  itemMaxHistoryCount: 50
```