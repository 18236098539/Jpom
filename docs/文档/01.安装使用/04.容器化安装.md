---
title: 容器化安装
date: 2022-06-11 16:11:41
permalink: /pages/820286/
tags: 
  - null
categories: 
  - docs
  - 文档
  - 安装使用
---


# 容器化安装（docker）

[安装 docker](./07.安装docker.md)

> 容器化安装仅提供服务端版。由于容器和宿主机环境隔离，而导致插件端的很多功能无法正常使用，因此对插件端容器化意义不大。

```
docker pull jpomdocker/jpom
docker run -d -p 2122:2122 \
	--name jpom-server \
	-v /etc/localtime:/etc/localtime:ro \
	-v /home/jpom-server/logs:/usr/local/jpom-server/logs \
	-v /home/jpom-server/data:/usr/local/jpom-server/data \
	-v /home/jpom-server/conf:/usr/local/jpom-server/conf \
	jpomdocker/jpom
```

## 查看Jpom服务端镜像是否启动成功

> 执行后看到有输出，则说明启动成功，此时可通过`ip:2122`访问服务端
```
docker ps
```

## 查看服务端在宿主机的目录（使用目录挂载创建的容器）
```
日志目录：/home/jpom-server/logs
数据目录：/home/jpom-server/data
配置目录：/home/jpom-server/conf
```

## 查看服务端在宿主机的目录（使用容器卷创建的容器）
> 执行后找到`Mountpoint`字段后面的值，即为宿主机上的目录
```
docker inspect jpom-server-vol
```

# 更新JPOM版本

## 在JPOM项目管理系统中更新（推荐）

1. 首先，你要有一个zip包，可以自己手动打包或者下载我们打包好的最新版的包[https://jpom.top/pages/all-downloads/](https://jpom.top/pages/all-downloads/)
    1. 下载里面包含插件端和服务端端包，您需要解压获取服务端包
2. 进入项目管理系统，在右侧的最后找到`系统管理`-->`在线升级`-->点击`选择升级文件`，把你刚才下载好的包上传上去
3. 耐心等待自动更新完成


## 如果是使用Docker的话，还可以去容器卷中替换掉原有的jar包进行更新

1. 同上
2. 打开zip包，找到里面的`lib`目录，把里面的jar文件提取出来，并且把jar文件上传至服务器
3. 找到Docker容器在宿主机的目录（可执行`docker inspect jpom-server-vol`命令查看`Mountpoint`字段的值）
4. 进入宿主机的lib目录，（执行`cat upgrade.json`，查看`newJar`来获取当前jar的名称）
5. 把你上传的jar改成和`newJar`字段同名的值，然后替换掉原来目录里的（如果里面只有一个jar文件，直接改成里面jar文件的名称即可）
6. 重启容器`docker restart jpom-server`
